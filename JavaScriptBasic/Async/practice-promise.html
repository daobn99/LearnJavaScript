<head></head>
<script>
    const users = [
        { userId: 1, name: "nam" },
        { userId: 2, name: "son dang" },
        { userId: 3, name: "vinh" }
    ];

    const comments = [
        {
            id: 1,
            userId: 1,
            content: "ra video moi chua ad"
        },
        {
            id: 2,
            userId: 2,
            content: "tuan sau ra nha e"
        },
        {
            id: 3,
            userId: 1,
            content: "thankiu a"
        }
    ];

    /**1. Lấy comments
     * 2. Từ comments lấy ra userId 
     *  từ userId lấy ra user name tương ứng 
    */
    const getUsersById = (userIdList) => {
        return new Promise((resolve) => {
            const result = users.filter((user) => {
                return userIdList.includes(user.userId);
            });
            setTimeout(() => {
                resolve(result);
            }, 1000);
        })
    }

    const getComments = () => {
        return new Promise((resolve) => {
            setTimeout(() => {
                resolve(comments);
            }, 1000);
        })
    }
    getComments()
        .then((comments) => {
            const userIdList = comments.map((comment) => {
                return comment.userId;
            });
            return getUsersById(userIdList).then((users) => {  // return của then thứ nhất sẽ trả về kết quả sang cái then thứ 2 
                return {
                    user: users,
                    comment: comments
                }
            })
        }
        )
        .then((data) => {  // return kết quả của then bên trên trả về đây 
            console.log(data);
        })
    
</script>